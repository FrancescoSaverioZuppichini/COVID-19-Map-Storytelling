(window["webpackJsonpreact-js"]=window["webpackJsonpreact-js"]||[]).push([[0],{114:function(e,t){},166:function(e,t,a){e.exports=a(278)},171:function(e,t,a){},173:function(e,t,a){},274:function(e,t){},278:function(e,t,a){"use strict";a.r(t);var n=a(4),i=a.n(n),r=a(144),o=a.n(r),l=(a(171),a(13)),c=a(11),s=a.n(c),d=a(20),u=a(110),m=a(2),h=a(1),p=a(7),v=a(5),f=a(8),g=(a(173),{style:"mapbox://styles/mapbox/dark-v10",accessToken:"pk.eyJ1IjoienVwcGlmIiwiYSI6ImNqdm96Z3d2ejFibG80OXZuZWdwMWgyemwifQ.aFnHrPBYUqnYcK2jAwzAZA",showMarkers:!0,theme:"light",alignment:"left",header:"# COVID-19\n## A story told by maps\n*By a Francesco Saverio Zuppichini and Riccardo Pisoni*\n\nWe decided to tell the story of the new pandemic known as *corona virus* (COVID-19) using maps. At any time you can press the button on the down right with the hazard icon to see all the cases on the story's date in the world.\n\n**Behind each number there is a person**, remember it.\n\t",title:"COVID-19",subtitle:"A story told by maps",byline:"By a Francesco Saverio Zuppichini and Riccardo Pisoni",footer:"Source: source citations, etc.",chapters:[{id:0,name:"0",location:{longitude:102.63073,latitude:35.53723,zoom:3,pitch:0,bearing:0},countries:["China"]},{id:1,date:"31-12-2019",name:"0",location:{longitude:114.301859,latitude:30.592357,zoom:10,pitch:60,bearing:0},duration:4e3},{id:2,date:"02-01-2020",name:"0",location:{longitude:114.275273,latitude:30.66588,zoom:15,pitch:15,bearing:0},marker:{longitude:114.28039,latitude:30.66877}},{id:3,date:"22-01-2020",name:"0",location:{longitude:9.86052,latitude:27.91264,zoom:2.2,pitch:0,bearing:0},duration:4e3,countries:["China","Hong Kong","Taiwan","United States of America","Japan","Thailand","South Korea"]},{id:4,date:"22-01-2020",name:"1",location:{longitude:114.258286,latitude:30.617847,zoom:14,pitch:30,bearing:0},marker:{longitude:114.261636,latitude:30.61781}},{id:5,date:"27-01-2020",name:"0",location:{longitude:104.68358,latitude:33.21781,zoom:4,pitch:30,bearing:0},duration:3e3},{id:6,date:"27-01-2020",name:"1",location:{longitude:-117.60365,latitude:34.05862,zoom:12,pitch:0,bearing:0},marker:{longitude:-117.60365,latitude:34.05862},duration:5e3},{id:7,name:"first-patients",slide:!0},{id:8,date:"29-01-2020",name:"0",location:{longitude:114.275273,latitude:30.66588,zoom:6,pitch:45,bearing:0},duration:2e3},{id:9,date:"29-01-2020",name:"1",location:{longitude:7.33942,latitude:50.81065,zoom:5,pitch:30,bearing:0},duration:3e3,countries:["Germany"]},{id:10,date:" 31-01-2020",name:"0",location:{longitude:7.33942,latitude:50.81065,zoom:6,pitch:30,bearing:0},countries:["Germany"]},{id:11,date:"02-02-2020",name:"0",location:{longitude:119.20476,latitude:10.76389,zoom:5,pitch:0,bearing:0},duration:3e3,countries:["Philippines"]},{id:12,date:"03-02-2020",name:"0",location:{longitude:9.86052,latitude:27.91264,zoom:3,pitch:0,bearing:0},duration:1e3},{id:13,date:"04-02-2020",name:"0",location:{longitude:139.56233,latitude:35.4311,zoom:11,pitch:0,bearing:0},duration:4e3},{id:14,date:"04-02-2020",name:"1",location:{longitude:-107.68517,latitude:38.67691,zoom:3,pitch:0,bearing:0},duration:3e3,countries:["US"]},{id:15,date:"05-02-2020",name:"0",location:{longitude:-107.68517,latitude:38.67691,zoom:4,pitch:0,bearing:0},duration:3e3},{id:16,date:"06-02-2020",name:"0",location:{longitude:102.63073,latitude:35.53723,zoom:3,pitch:0,bearing:0}},{id:17,date:"07-02-2020",name:"0",location:{longitude:113.49339,latitude:30.66588,zoom:6,pitch:30,bearing:0}},{id:18,date:"07-02-2020",name:"1",location:{longitude:-114.95366,latitude:55.91607,zoom:3.8,pitch:0,bearing:0},countries:["Canada"]}]}),y=a(289),C=a(292),b=a(152),E=a(98),D=a(146),w=a.n(D),S=a(293),F=a(82),M=a.n(F),x=a(111),I=a.n(x),k=a(147),N=a.n(k),z=a(90);var j={break:function(){return z.a.BREAK},ease:a(288).a},Y={latitude:15.38585,longitude:26.68114};function R(e){e.total;var t=e.country,a=void 0===t?{}:t,n=e.date;return i.a.createElement("div",{id:"covidDataInfo",className:"card light"},i.a.createElement("div",null,i.a.createElement("p",null,"Cases on ",n.format("DD-MM-YYYY")),i.a.createElement("p",null,a.name),i.a.createElement("div",null,i.a.createElement("div",{className:"flex baseline text-row"},i.a.createElement("p",null,"Confirmed:"),i.a.createElement("h2",null,a.Confirmed)),i.a.createElement("div",{className:"flex baseline text-row"},i.a.createElement("p",null,"Deaths:"),i.a.createElement("h3",null,a.Deaths)),i.a.createElement("div",{className:"flex baseline text-row"},i.a.createElement("p",null,"Recovered:"),i.a.createElement("h3",null,a.Recovered)))))}var O=a(129);function _(e){var t=e.header,a=e.theme;return i.a.createElement("div",null,t&&i.a.createElement("div",{id:"header",className:a},i.a.createElement(O,{source:t})))}var A=a(129),L={left:"lefty",center:"centered",right:"righty"};function T(){return i.a.createElement("div",{className:"chapter-dummy"},i.a.createElement("div",{className:"chapter_date-dummy"}),i.a.createElement("div",{className:"chapter_title-dummy"}),i.a.createElement("div",{className:"chapter_text-dummy"}),i.a.createElement("div",{className:"chapter_text-dummy"}),i.a.createElement("div",{className:"chapter_text-dummy"}))}function B(e){var t=e.id,a=e.theme,n=e.text,r=e.currentChapterID,o=e.covidData,l=e.slide,c=void 0!==l&&l,s=e.alignment,d=t===r?"step active":"step";return d+=c?" slide":"",d+=" ".concat(L[void 0===s?"left":s]),i.a.createElement("div",{id:t,className:d+" card"},i.a.createElement("div",{className:a},n?i.a.createElement("div",{className:"flex baseline"},o.Confirmed>0?i.a.createElement("div",{className:"flex baseline text-row"},i.a.createElement("p",null,"Confirmed: ",o.Confirmed),i.a.createElement("p",null,"Deaths: ",o.Deaths," "),i.a.createElement("p",null,"Recovered: ",o.Recovered," "),"  "):"",i.a.createElement("div",{className:"flex--grow"})):"",n?i.a.createElement(A,{source:n}):i.a.createElement(T,null)))}function G(e){var t=e.chapters,a=e.theme,n=e.currentChapterID,r=e.covidData;return i.a.createElement("div",{id:"story"},i.a.createElement("div",{id:"features"},t.map((function(e){return i.a.createElement(B,Object.assign({key:e.id,theme:a},e,{currentChapterID:n,covidData:r}))}))))}function P(e){e.theme;var t=e.onClick,a=e.isInFullMap?"/text_fields-24px.svg":"/biohazard.png";return i.a.createElement("button",{id:"hazardButton",onClick:t,className:""},i.a.createElement("img",{src:a}))}function V(e){var t=e.footer,a=e.theme;return i.a.createElement("div",null,t&&i.a.createElement("div",{id:"footer",className:a},i.a.createElement("p",null,t)))}var W={longitude:15.38585,latitude:26.68114,zoom:2,pitch:0,bearing:0},Z=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(i)))).state={currentChapter:g.chapters[0],viewState:W,isFlyingToFullMap:!1,isFlyingFromFullMap:!1,isInFullMap:!1,date:g.chapters[0].date,data:[],totalCovidData:{},countryCovidData:{},geoCountries:[]},a.setChapterLocation=function(e){var t=a.state.currentChapter.id>e.id?a.state.currentChapter.duration:e.duration,n=void 0===e.date?a.state.date:e.date;a.setState({currentChapter:e,date:n,isInFullMap:!1,viewState:Object(u.a)({},e.location,{},{transitionEasing:j[e.transition||"ease"],transitionDuration:t||1e3,transitionInterpolator:new y.a})})},a.mapOnLoad=function(){w()().setup({step:".step",offset:.5,progress:!0}).onStepEnter(function(){var e=Object(d.a)(s.a.mark((function e(t){var n,i,r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=g.chapters[t.element.id]).date=n.date?I()(n.date,"DD-MM-YYYY"):void 0,i=n.date?n.date.format("DD-MM-YYYY")+"-":"",e.next=5,M.a.get("/chapters/".concat(i).concat(n.name,".md"));case 5:r=e.sent,o=r.data,n.text=o,n.date=n.date?I()(n.date,"DD-MM-YYYY"):n.date,n.location?(a.setChapterLocation(n),n.date&&a.getDataFromDate(n.date)):a.setState({currentChapter:n,isInFullMap:!1});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).onStepExit((function(){}))},a.onHazardButton=function(){if(a.state.isInFullMap)a.setState({isFlyingFromFullMap:!0,isFlyingToFullMap:!1,isInFullMap:!1}),a.setChapterLocation(a.state.currentChapter);else{var e=Object(u.a)({},Y,{zoom:2},{transitionEasing:j.ease,transitionDuration:2e3,transitionInterpolator:new y.a});a.setState({viewState:e,isFlyingToFullMap:!0,isFlyingFromFullMap:!1,isInFullMap:!0}),setTimeout((function(){return a.setState({isFlyingToFullMap:!1})}),2e3)}},a.onViewStateChange=function(e){var t=e.viewState;a.setState({viewState:t})},a.mapStyle=function(){return{zIndex:a.state.isInFullMap?99:-1,position:"fixed"}},a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=[M.a.get("/countries-small.geojson"),M.a.get("/china-provinces.geojson")];Promise.all(t).then((function(e){var t=e[0].data,a=e[1].data;return a.features=a.features.map((function(e){return e.properties.name=e.properties.NAME,e})),{type:t.type,features:[].concat(Object(l.a)(t.features),Object(l.a)(a.features))}})).then((function(t){return e.setState({geoCountries:t})}))}},{key:"getChapterGeoLayer",value:function(e){var t=e.countries,a=[];if(t&&this.state.geoCountries.features){var n=this.state.geoCountries.features.filter((function(e){return t.includes(e.properties.name)}));a={type:this.state.geoCountries.type,features:n}}return new S.a({id:"geojson-layer",data:a,pickable:!0,filled:!0,extruded:!0,lineWidthScale:20,lineWidthMinPixels:2,getFillColor:[155,0,0,100],getRadius:100,getLineWidth:1,getElevation:30})}},{key:"getCovidGeoLayer",value:function(){var e=this,t=function(t){return e.state.data.find((function(e){return e["Province/State"]==t.properties.name||e["Country/Region"]==t.properties.name}))},a=function(e){var t=e["Province/State"],a=e["Country/Region"];return"".concat(""!=t?t+" ":"").concat(a)};return new S.a({id:"geojson-layer",data:this.state.geoCountries,pickable:!0,stroked:!0,filled:!0,getFillColor:function(a){var n=[0,0,0,0],i=t(a);i&&(i.Confirmed>0&&(n=[255*(Number(i.Confirmed)/(e.state.totalCovidData.Confirmed/150)),0,0,100]));return n},getLineColor:[255,255,255,255],onHover:function(n){var i=n.object;n.x,n.y;if(i){var r=t(i),o={Confirmed:0,Deaths:0,Recovered:0,name:i.properties.name};r&&(o={Confirmed:Number(r.Confirmed),Deaths:Number(r.Deaths),Recovered:Number(r.Recovered),name:a(r)}),e.setState({countryCovidData:o})}}})}},{key:"getDataFromDate",value:function(e){var t=this,a=e.format("MM-DD-YYYY"),n="".concat("/api/v1/data/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_daily_reports/").concat(a,".csv"),i=N()();return M.a.get(n).then((function(e){return e.data})).then((function(e){return i.fromString(e)})).then((function(e){return function(e,t){var a={Confirmed:0,Deaths:0,Recovered:0},n=!0,i=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;s["Country/Region"]===t&&(a.Confirmed+=Number(s.Confirmed),a.Deaths+=Number(s.Deaths),a.Recovered+=Number(s.Recovered))}}catch(d){i=!0,r=d}finally{try{n||null==c.return||c.return()}finally{if(i)throw r}}return a["Country/Region"]=t,[a].concat(Object(l.a)(e))}(e,"US")})).then((function(e){var a=function(e){var t={Confirmed:0,Deaths:0,Recovered:0},a=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var l=r.value;t.Confirmed+=Number(l.Confirmed),t.Deaths+=Number(l.Deaths),t.Recovered+=Number(l.Recovered)}}catch(c){n=!0,i=c}finally{try{a||null==o.return||o.return()}finally{if(n)throw i}}return t}(e);t.setState({data:e,totalCovidData:a})}))}},{key:"render",value:function(){var e=this.state.isInFullMap&&!this.state.isFlyingToFullMap?this.getCovidGeoLayer():this.getChapterGeoLayer(this.state.currentChapter);return i.a.createElement("div",null,i.a.createElement(_,g),i.a.createElement(C.a,{viewState:this.state.viewState,onViewStateChange:this.onViewStateChange,controller:b.a,layers:[e],style:this.mapStyle()},i.a.createElement(E.b,{mapStyle:"mapbox://styles/zuppif/ck7dq0q6x1hwo1inu7n734ou1",mapboxApiAccessToken:g.accessToken,onLoad:this.mapOnLoad},this.state.currentChapter.marker&&!this.state.isInFullMap?i.a.createElement(E.a,this.state.currentChapter.marker,i.a.createElement("img",{src:"https://i.imgur.com/MK4NUzI.png"})):"")),this.state.isInFullMap?i.a.createElement(R,{total:this.state.totalCovidData,country:this.state.countryCovidData,date:this.state.date}):"",i.a.createElement(G,Object.assign({},g,{currentChapterID:this.state.currentChapter.id,covidData:this.state.totalCovidData})),i.a.createElement(P,{theme:g.theme,onClick:this.onHazardButton,isInFullMap:this.state.isInFullMap}),i.a.createElement(V,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[166,1,2]]]);
//# sourceMappingURL=main.5ccc93f1.chunk.js.map