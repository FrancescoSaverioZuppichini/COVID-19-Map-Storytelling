(window["webpackJsonpreact-js"]=window["webpackJsonpreact-js"]||[]).push([[0],{115:function(e,t){},167:function(e,t,a){e.exports=a(280)},172:function(e,t,a){},174:function(e,t,a){},276:function(e,t){},280:function(e,t,a){"use strict";a.r(t);var n=a(4),i=a.n(n),o=a(145),r=a.n(o),l=(a(172),a(13)),c=a(11),s=a.n(c),d=a(20),u=a(35),m=a(2),h=a(1),p=a(7),v=a(5),f=a(8),g=(a(174),{longitude:9.86052,latitude:27.91264,zoom:2.2}),b={longitude:101.30385,latitude:34.05125,zoom:5},y={longitude:139.56233,latitude:35.4311,zoom:11},C={style:"mapbox://styles/mapbox/dark-v10",accessToken:"pk.eyJ1IjoienVwcGlmIiwiYSI6ImNqdm96Z3d2ejFibG80OXZuZWdwMWgyemwifQ.aFnHrPBYUqnYcK2jAwzAZA",showMarkers:!0,theme:"light",alignment:"left",header:"# COVID-19 A story told by maps\n*By a [Francesco Saverio Zuppichini](https://www.linkedin.com/in/francesco-saverio-zuppichini-94659a150/) and [Riccardo Pisoni](https://www.linkedin.com/in/riccardo-pisoni/)*\n\nWe decided to tell the story of the new pandemic known as *corona virus* using maps. When the data is available, you can click the button on the downright with the hazard icon to see all the cases on the story's date in the worldwide. To start reading, just scroll down.\n\n**Behind each number there is a person**, remember it.\n\t",title:"COVID-19",subtitle:"A story told by maps",byline:"By a Francesco Saverio Zuppichini and Riccardo Pisoni",footer:"COVMap story",chapters:[{name:"0",location:{longitude:102.63073,latitude:35.53723,zoom:3,pitch:0,bearing:0},countries:["China"]},{date:"31-12-2019",name:"0",location:{longitude:114.301859,latitude:30.592357,zoom:10,pitch:60,bearing:0},duration:4e3},{date:"02-01-2020",name:"0",location:{longitude:114.275273,latitude:30.66588,zoom:15,pitch:15,bearing:0},marker:{longitude:114.28039,latitude:30.66877}},{date:"22-01-2020",name:"0",location:{longitude:9.86052,latitude:27.91264,zoom:2.2,pitch:0,bearing:0},duration:4e3,countries:["China","Hong Kong","Taiwan","United States of America","Japan","Thailand","South Korea"]},{date:"22-01-2020",name:"1",location:{longitude:114.258286,latitude:30.617847,zoom:14,pitch:30,bearing:0},marker:{longitude:114.261636,latitude:30.61781}},{date:"27-01-2020",name:"0",location:{longitude:104.68358,latitude:33.21781,zoom:4,pitch:30,bearing:0},duration:3e3},{date:"27-01-2020",name:"1",location:{longitude:-117.60365,latitude:34.05862,zoom:12,pitch:0,bearing:0},marker:{longitude:-117.60365,latitude:34.05862},duration:5e3},{name:"how-it-kills",slide:!0},{date:"29-01-2020",name:"0",location:{longitude:114.275273,latitude:30.66588,zoom:6,pitch:45,bearing:0},duration:2e3},{date:"29-01-2020",name:"1",location:{longitude:7.33942,latitude:50.81065,zoom:5,pitch:30,bearing:0},duration:3e3,countries:["Germany"]},{date:"30-01-2020",name:"0",location:{longitude:9.86052,latitude:27.91264,zoom:2.5,pitch:0,bearing:0},duration:3e3},{date:" 31-01-2020",name:"0",location:{longitude:7.33942,latitude:50.81065,zoom:6,pitch:30,bearing:0},countries:["Germany"]},{date:"02-02-2020",name:"0",location:{longitude:119.20476,latitude:10.76389,zoom:5,pitch:0,bearing:0},duration:3e3,countries:["Philippines"]},{date:"03-02-2020",name:"0",location:{longitude:9.86052,latitude:27.91264,zoom:3,pitch:0,bearing:0},duration:1e3},{date:"04-02-2020",name:"0",location:Object(u.a)({},y),duration:4e3},{date:"04-02-2020",name:"1",location:{longitude:-107.68517,latitude:38.67691,zoom:3,pitch:0,bearing:0},duration:3e3,countries:["US"]},{date:"05-02-2020",name:"0",location:{longitude:-107.68517,latitude:38.67691,zoom:4,pitch:0,bearing:0},duration:3e3},{date:"06-02-2020",name:"0",location:{longitude:102.63073,latitude:35.53723,zoom:3,pitch:0,bearing:0}},{date:"07-02-2020",name:"0",location:{longitude:113.49339,latitude:30.66588,zoom:6,pitch:30,bearing:0}},{date:"07-02-2020",name:"1",location:{longitude:-114.95366,latitude:55.91607,zoom:3.8,pitch:0,bearing:0},countries:["Canada"]},{date:"10-02-2020",name:"0",location:Object(u.a)({},g,{pitch:0})},{date:"11-02-2020",name:"0",location:Object(u.a)({},g,{zoom:2.5})},{date:"11-02-2020",name:"1",location:{longitude:-117.52474,latitude:32.73788,zoom:9},duration:2e3},{date:"12-02-2020",name:"0",location:Object(u.a)({},g,{zoom:2.5})},{date:"13-02-2020",name:"0",location:Object(u.a)({},g,{zoom:2.1})},{name:"sleep",slide:!0},{date:"14-02-2020",name:"0",location:Object(u.a)({},b)},{date:"15-02-2020",name:"0",location:Object(u.a)({},g,{zoom:2})},{date:"16-02-2020",name:"0",location:Object(u.a)({},y),duration:3e3},{date:"17-02-2020",name:"0",location:Object(u.a)({},b,{zoom:5.5}),duration:2e3},{date:"17-02-2020",name:"1",location:Object(u.a)({},g),duration:2e3},{name:"fake_news",slide:!0},{date:"18-02-2020",name:"0",location:Object(u.a)({},y),duration:2e3},{date:"19-02-2020",name:"0",location:Object(u.a)({},{longitude:-123.26327,latitude:49.2648,zoom:11}),duration:3e3},{date:"19-02-2020",name:"1",location:Object(u.a)({},{longitude:113.8273,latitude:30.57516,zoom:9},{pitch:30})}]},E=a(291),w=a(294),D=a(153),S=a(99),z=a(147),F=a.n(z),M=a(295),j=a(83),k=a.n(j),x=a(111),O=a(112),I=a.n(O),N=a(148),Y=a.n(N),R=a(91);var _={break:function(){return R.a.BREAK},ease:a(290).a},T={latitude:15.38585,longitude:26.68114};function A(e){e.total;var t=e.country,a=void 0===t?{}:t,n=e.date;return i.a.createElement("div",{id:"covidDataInfo",className:"card light"},i.a.createElement("div",null,i.a.createElement("p",null,"Cases on ",n.format("DD-MM-YYYY")),i.a.createElement("p",null,a.name),i.a.createElement("div",null,i.a.createElement("div",{className:"flex baseline text-row"},i.a.createElement("p",null,"Confirmed:"),i.a.createElement("h2",null,a.Confirmed)),i.a.createElement("div",{className:"flex baseline text-row"},i.a.createElement("p",null,"Deaths:"),i.a.createElement("h3",null,a.Deaths)),i.a.createElement("div",{className:"flex baseline text-row"},i.a.createElement("p",null,"Recovered:"),i.a.createElement("h3",null,a.Recovered)))))}var L=a(130);function B(e){var t=e.header,a=e.theme;return i.a.createElement("div",{style:{paddingTop:"2vh"}},t&&i.a.createElement("div",{id:"header",className:a},i.a.createElement(L,{source:t})))}var G=a(130),W={left:"lefty",center:"centered",right:"righty"};function P(){return i.a.createElement("div",{className:"chapter-dummy"},i.a.createElement("div",{className:"chapter_date-dummy"}),i.a.createElement("div",{className:"chapter_title-dummy"}),i.a.createElement("div",{className:"chapter_text-dummy"}),i.a.createElement("div",{className:"chapter_text-dummy"}),i.a.createElement("div",{className:"chapter_text-dummy"}))}function V(e){var t=e.id,a=e.theme,n=e.text,o=e.currentChapterID,r=e.covidData,l=e.slide,c=void 0!==l&&l,s=e.alignment,d=t===o?"step active":"step";return d+=c?" slide":"",d+=" ".concat(W[void 0===s?"left":s]),i.a.createElement("div",{id:t,className:d+" card"},i.a.createElement("div",{className:a},n?i.a.createElement("div",{className:"flex baseline"},r.Confirmed>0?i.a.createElement("div",{className:"flex baseline text-row"},i.a.createElement("p",null,"Confirmed: ",r.Confirmed),i.a.createElement("p",null,"Deaths: ",r.Deaths," "),i.a.createElement("p",null,"Recovered: ",r.Recovered," "),"  "):"",i.a.createElement("div",{className:"flex--grow"})):"",n?i.a.createElement(G,{source:n}):i.a.createElement(P,null)))}function Z(e){var t=e.chapters,a=e.theme,n=e.currentChapterID,o=e.covidData;return i.a.createElement("div",{id:"story"},i.a.createElement("div",{id:"features"},t.map((function(e,t){return i.a.createElement(V,Object.assign({key:t,theme:a},e,{currentChapterID:n,covidData:o}))}))))}function H(e){e.theme;var t=e.onClick,a=e.isInFullMap?"/text_fields-24px.svg":"/biohazard.png";return i.a.createElement("button",{id:"hazardButton",onClick:t,className:""},i.a.createElement("img",{src:a}))}function K(e){var t=e.footer,a=e.theme;return i.a.createElement("div",null,t&&i.a.createElement("div",{id:"footer",className:a},i.a.createElement("p",null,t)))}var U={longitude:15.38585,latitude:26.68114,zoom:2,pitch:0,bearing:0},q=function(e){var t=e.theme;return i.a.createElement("div",{className:"card",style:{margin:"2vh"}},i.a.createElement("div",{className:t},i.a.createElement("h2",null,"Map is not supported on iOS."),i.a.createElement("h4",null,"(no stable WebGL2)"),"Please open the website from a computer or an Android phone to see the dynamic map."))},J=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(i)))).state={currentChapter:C.chapters[0],viewState:U,isFlyingToFullMap:!1,isFlyingFromFullMap:!1,isInFullMap:!1,date:C.chapters[0].date,data:[],totalCovidData:{},countryCovidData:{},geoCountries:[]},a.scroller=F()(),a.setChapterLocation=function(e,t){a.state.currentChapter.id,e.id;var n="down"==t?a.state.currentChapter.duration:e.duration;a.setState({currentChapter:e,date:e.date,isInFullMap:!1,viewState:Object(u.a)({},e.location,{totalCovidData:{},transitionEasing:_[e.transition||"ease"],transitionDuration:n||1e3,transitionInterpolator:new E.a})})},a.onHazardButton=function(){if(a.state.isInFullMap)a.setState({isFlyingFromFullMap:!0,isFlyingToFullMap:!1,isInFullMap:!1}),a.setChapterLocation(a.state.currentChapter);else{var e=Object(u.a)({},T,{zoom:2},{transitionEasing:_.ease,transitionDuration:2e3,transitionInterpolator:new E.a});a.setState({viewState:e,isFlyingToFullMap:!0,isFlyingFromFullMap:!1,isInFullMap:!0}),setTimeout((function(){return a.setState({isFlyingToFullMap:!1})}),2e3)}},a.onViewStateChange=function(e){var t=e.viewState;a.setState({viewState:t})},a.mapStyle=function(){return{zIndex:a.state.isInFullMap?99:-1,position:"fixed"}},a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",(function(){return e.scroller.resize()})),this.scroller.setup({step:".step",offset:.5,progress:!0}).onStepEnter(function(){var t=Object(d.a)(s.a.mark((function t(a){var n,i,o,r,l,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.element,n=a.index,i=a.direction,console.log(i),(o=C.chapters[n]).id=n,o.date=o.date?I()(o.date,"DD-MM-YYYY"):void 0,r=o.date?o.date.format("DD-MM-YYYY")+"-":"",t.next=8,k.a.get("/chapters/".concat(r).concat(o.name,".md"));case 8:l=t.sent,c=l.data,o.text=c,o.date=o.date?I()(o.date,"DD-MM-YYYY"):o.date,o.location?(e.setChapterLocation(o,i),o.date&&e.getDataFromDate(o.date)):e.setState({currentChapter:o,isInFullMap:!1});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).onStepExit((function(){}));var t=[k.a.get("/countries-small.geojson"),k.a.get("/china-provinces.geojson")];Promise.all(t).then((function(e){var t=e[0].data,a=e[1].data;return a.features=a.features.map((function(e){return e.properties.name=e.properties.NAME,e})),{type:t.type,features:[].concat(Object(l.a)(t.features),Object(l.a)(a.features))}})).then((function(t){return e.setState({geoCountries:t})}))}},{key:"getChapterGeoLayer",value:function(e){var t=e.countries,a=[];if(t&&this.state.geoCountries.features){var n=this.state.geoCountries.features.filter((function(e){return t.includes(e.properties.name)}));a={type:this.state.geoCountries.type,features:n}}return new M.a({id:"geojson-layer",data:a,pickable:!0,filled:!0,extruded:!0,lineWidthScale:20,lineWidthMinPixels:2,getFillColor:[155,0,0,100],getRadius:100,getLineWidth:1,getElevation:30})}},{key:"getCovidGeoLayer",value:function(){var e=this,t=function(t){return e.state.data.find((function(e){return e["Province/State"]==t.properties.name||e["Country/Region"]==t.properties.name}))},a=function(e){var t=e["Province/State"],a=e["Country/Region"];return"".concat(""!=t?t+" ":"").concat(a)};return new M.a({id:"geojson-layer",data:this.state.geoCountries,pickable:!0,stroked:!0,filled:!0,getFillColor:function(a){var n=[0,0,0,0],i=t(a);i&&(i.Confirmed>0&&(n=[255*(Number(i.Confirmed)/(e.state.totalCovidData.Confirmed/150)),0,0,100]));return n},getLineColor:[255,255,255,255],onHover:function(n){var i=n.object;n.x,n.y;if(i){var o=t(i),r={Confirmed:0,Deaths:0,Recovered:0,name:i.properties.name};o&&(r={Confirmed:Number(o.Confirmed),Deaths:Number(o.Deaths),Recovered:Number(o.Recovered),name:a(o)}),e.setState({countryCovidData:r})}}})}},{key:"getDataFromDate",value:function(e){var t=this,a=e.format("MM-DD-YYYY"),n="".concat("/api/v1/data/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_daily_reports/").concat(a,".csv"),i=Y()();return k.a.get(n).then((function(e){return e.data})).then((function(e){return i.fromString(e)})).then((function(e){return function(e,t){var a={Confirmed:0,Deaths:0,Recovered:0},n=!0,i=!1,o=void 0;try{for(var r,c=e[Symbol.iterator]();!(n=(r=c.next()).done);n=!0){var s=r.value;s["Country/Region"]===t&&(a.Confirmed+=Number(s.Confirmed),a.Deaths+=Number(s.Deaths),a.Recovered+=Number(s.Recovered))}}catch(d){i=!0,o=d}finally{try{n||null==c.return||c.return()}finally{if(i)throw o}}return a["Country/Region"]=t,[a].concat(Object(l.a)(e))}(e,"US")})).then((function(e){var a=function(e){var t={Confirmed:0,Deaths:0,Recovered:0},a=!0,n=!1,i=void 0;try{for(var o,r=e[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){var l=o.value;t.Confirmed+=Number(l.Confirmed),t.Deaths+=Number(l.Deaths),t.Recovered+=Number(l.Recovered)}}catch(c){n=!0,i=c}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}return t}(e);t.setState({data:e,totalCovidData:a})})).catch((function(e){return t.setState({data:[],totalCovidData:{}})}))}},{key:"render",value:function(){var e=this.state.isInFullMap&&!this.state.isFlyingToFullMap?this.getCovidGeoLayer():this.getChapterGeoLayer(this.state.currentChapter),t=this.state.data.length>0;return i.a.createElement("div",null,x.isIOS13&&i.a.createElement(q,C),!x.isIOS13&&i.a.createElement(w.a,{viewState:this.state.viewState,onViewStateChange:this.onViewStateChange,controller:D.a,layers:[e],style:this.mapStyle()},i.a.createElement(S.b,{mapStyle:"mapbox://styles/zuppif/ck7dq0q6x1hwo1inu7n734ou1",mapboxApiAccessToken:C.accessToken},this.state.currentChapter.marker&&!this.state.isInFullMap?i.a.createElement(S.a,this.state.currentChapter.marker,i.a.createElement("img",{src:"https://i.imgur.com/MK4NUzI.png"})):"")),i.a.createElement(B,C),this.state.isInFullMap?i.a.createElement(A,{total:this.state.totalCovidData,country:this.state.countryCovidData,date:this.state.date}):"",i.a.createElement(Z,Object.assign({},C,{currentChapterID:this.state.currentChapter.id,covidData:this.state.totalCovidData})),t&&i.a.createElement(H,{theme:C.theme,onClick:this.onHazardButton,isInFullMap:this.state.isInFullMap}),i.a.createElement(K,C))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[167,1,2]]]);
//# sourceMappingURL=main.1cb4a29a.chunk.js.map